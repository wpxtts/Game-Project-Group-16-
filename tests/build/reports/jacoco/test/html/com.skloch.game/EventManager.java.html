<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EventManager.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tests</a> &gt; <a href="index.source.html" class="el_package">com.skloch.game</a> &gt; <span class="el_source">EventManager.java</span></div><h1>EventManager.java</h1><pre class="source lang-java linenums">package com.skloch.game;

import com.badlogic.gdx.Game;
import com.badlogic.gdx.scenes.scene2d.actions.Actions;
import com.badlogic.gdx.scenes.scene2d.actions.RunnableAction;
import com.badlogic.gdx.utils.Array;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.concurrent.ThreadLocalRandom;
import java.util.concurrent.TimeUnit;

/**
 * A class that maps Object's event strings to actual Java functions.
 */
public class EventManager {
    private final GameScreen game;
    public final HashMap&lt;String, Integer&gt; activityEnergies;
    public final HashMap&lt;String, String&gt; objectInteractions;
<span class="fc" id="L20">    private String[] activities = {&quot;studying&quot;, &quot;meet_friends&quot;, &quot;eating&quot;, &quot;flowers&quot;, &quot;town&quot;, &quot;shop&quot;, &quot;gym&quot;, &quot;duck_pond&quot;, &quot;library&quot;, &quot;east&quot;};</span>
<span class="fc" id="L21">    public static String[] streak_activities = {&quot;studying&quot;, &quot;flowers&quot;, &quot;town&quot;, &quot;shop&quot;, &quot;library&quot;, &quot;early_bird&quot;, &quot;night_owl&quot;, &quot;eating&quot;};</span>
    private final Array&lt;String&gt; talkTopics;

    public static HashMap&lt;String, Integer&gt; streaks, daily;
<span class="fc" id="L25">    public boolean catchup_used = false;</span>
<span class="fc" id="L26">    public int daily_study = 0;</span>
<span class="fc" id="L27">    public boolean gotBus = false;</span>
<span class="fc" id="L28">    public boolean breakfast, lunch, dinner = false;</span>

    /**
     * A class that maps Object's event strings to actual Java functions.
     * To run a function call event(eventString), to add arguments add dashes.
     * E.g. a call to the Piazza function with an arg of 1 would be: &quot;piazza-1&quot;
     * Which the function interprets as &quot;study at the piazza for 1 hour&quot;.
     * Object's event strings can be set in the Tiled map editor with a property called &quot;event&quot;
     *
     * @param game An instance of the GameScreen containing a player and dialogue box
     */
<span class="fc" id="L39">    public EventManager (GameScreen game) {</span>
<span class="fc" id="L40">        this.game = game;</span>

        // How much energy an hour of each activity should take
<span class="fc" id="L43">        activityEnergies = new HashMap&lt;String, Integer&gt;();</span>
<span class="fc bfc" id="L44" title="All 2 branches covered.">        for (String activity : activities){</span>
<span class="fc" id="L45">            activityEnergies.put(activity, 10);</span>
        }


        // Define what to say when interacting with an object whose text won't change
<span class="fc" id="L50">        objectInteractions = new HashMap&lt;String, String&gt;();</span>
<span class="fc" id="L51">        objectInteractions.put(&quot;chest&quot;, &quot;Open the chest?&quot;);</span>
<span class="fc" id="L52">        objectInteractions.put(&quot;comp_sci&quot;, &quot;Study in the Computer Science building?&quot;);</span>
<span class="fc" id="L53">        objectInteractions.put(&quot;rch&quot;, &quot;Meet your friends at Ron Cooke Hub?&quot;);</span>
<span class="fc" id="L54">        objectInteractions.put(&quot;accomodation&quot;, &quot;Go to sleep for the night?\nYour alarm is set for 8am.&quot;);</span>
<span class="fc" id="L55">        objectInteractions.put(&quot;piazza&quot;, null); // Changes, dynamically returned in getObjectInteraction</span>
<span class="fc" id="L56">        objectInteractions.put(&quot;tree&quot;, &quot;Speak to the tree?&quot;);</span>
<span class="fc" id="L57">        objectInteractions.put(&quot;flowers&quot;, &quot;Smell the flowers?&quot;);</span>
<span class="fc" id="L58">        objectInteractions.put(&quot;shop&quot;, &quot;Buy food from the shop?&quot;);</span>
<span class="fc" id="L59">        objectInteractions.put(&quot;gym&quot;, &quot;Work out at the gym?&quot;);</span>
<span class="fc" id="L60">        objectInteractions.put(&quot;duck_pond&quot;, &quot;Feed the ducks?&quot;);</span>
<span class="fc" id="L61">        objectInteractions.put(&quot;library&quot;, &quot;Study at the library?&quot;);</span>
<span class="fc" id="L62">        objectInteractions.put(&quot;town&quot;, &quot;Get the bus to town?&quot;);</span>
<span class="fc" id="L63">        objectInteractions.put(&quot;east&quot;, &quot;Get the bus back to east?&quot;);</span>

        // How much energy an hour of each activity should take
<span class="fc" id="L66">        streaks = new HashMap&lt;String, Integer&gt;();</span>
<span class="fc bfc" id="L67" title="All 2 branches covered.">        for (String streak_activity : streak_activities){</span>
<span class="fc" id="L68">            streaks.put(streak_activity, 0);</span>
        }

        // Limits number of times each streak can be increased to 3 times a day
<span class="fc" id="L72">        daily = new HashMap&lt;String, Integer&gt;();</span>
<span class="fc bfc" id="L73" title="All 2 branches covered.">        for (String streak_activity : streak_activities){</span>
<span class="fc" id="L74">            daily.put(streak_activity, 0);</span>
        }

        // Some random topics that can be chatted about
<span class="fc" id="L78">        String[] topics = {&quot;Dogs&quot;, &quot;Cats&quot;, &quot;Exams&quot;, &quot;Celebrities&quot;, &quot;Flatmates&quot;, &quot;Video games&quot;, &quot;Sports&quot;, &quot;Food&quot;, &quot;Fashion&quot;};</span>
<span class="fc" id="L79">        talkTopics = new Array&lt;String&gt;(topics);</span>
<span class="fc" id="L80">    }</span>

    public void event (String eventKey) throws InterruptedException {
<span class="nc" id="L83">        String[] args = eventKey.split(&quot;-&quot;);</span>

        // Important functions, most likely called after displaying text
<span class="nc bnc" id="L86" title="All 2 branches missed.">        if (args[0].equals(&quot;fadefromblack&quot;)) {</span>
<span class="nc" id="L87">            fadeFromBlack();</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">        } else if (args[0].equals(&quot;fadetoblack&quot;)) {</span>
<span class="nc" id="L89">            fadeToBlack();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">        } else if (args[0].equals(&quot;gameover&quot;)) {</span>
<span class="nc" id="L91">            game.GameOver();</span>
        }

        // Events related to objects
<span class="nc bnc" id="L95" title="All 15 branches missed.">        switch (args[0]) {</span>
            case &quot;tree&quot;:
<span class="nc" id="L97">                String textTree = treeEvent();</span>
<span class="nc" id="L98">                game.dialogueBox.setText(textTree);</span>
<span class="nc" id="L99">                break;</span>
            case &quot;chest&quot;:
<span class="nc" id="L101">                String textChest = chestEvent();</span>
<span class="nc" id="L102">                game.dialogueBox.setText(textChest);</span>
<span class="nc" id="L103">                break;</span>
            case &quot;piazza&quot;:
<span class="nc" id="L105">                String textPiazza = piazzaEvent(args);</span>
<span class="nc" id="L106">                game.dialogueBox.setText(textPiazza);</span>
<span class="nc" id="L107">                break;</span>
            case &quot;comp_sci&quot;:
<span class="nc" id="L109">                String textCompSci = compSciEvent(args);</span>
<span class="nc" id="L110">                game.dialogueBox.setText(textCompSci);</span>
<span class="nc" id="L111">                break;</span>
            case &quot;rch&quot;:
<span class="nc" id="L113">                String textRCH = ronCookEvent(args);</span>
<span class="nc" id="L114">                game.dialogueBox.setText(textRCH);</span>
<span class="nc" id="L115">                break;</span>
            case &quot;accomodation&quot;:
<span class="nc" id="L117">                accomEvent(args);</span>
<span class="nc" id="L118">                break;</span>
            case &quot;flowers&quot;:
<span class="nc" id="L120">                String textFlowers = flowersEvent(args);</span>
<span class="nc" id="L121">                game.dialogueBox.setText(textFlowers);</span>
<span class="nc" id="L122">                break;</span>
            case &quot;town&quot;:
<span class="nc" id="L124">                String textBusStop = busStopEvent(args);</span>
<span class="nc" id="L125">                game.dialogueBox.setText(textBusStop);</span>
<span class="nc" id="L126">                break;</span>
            case &quot;shop&quot;:
<span class="nc" id="L128">                String textShop = shopEvent(args);</span>
<span class="nc" id="L129">                game.dialogueBox.setText(textShop);</span>
<span class="nc" id="L130">                break;</span>
            case &quot;gym&quot;:
<span class="nc" id="L132">                String textGym = gymEvent(args);</span>
<span class="nc" id="L133">                game.dialogueBox.setText(textGym);</span>
<span class="nc" id="L134">                break;</span>
            case &quot;library&quot;:
<span class="nc" id="L136">                String textLibrary = libraryEvent(args);</span>
<span class="nc" id="L137">                game.dialogueBox.setText(textLibrary);</span>
<span class="nc" id="L138">                break;</span>
            case &quot;east&quot;:
<span class="nc" id="L140">                townBusStopEvent(args);</span>
<span class="nc" id="L141">                break;</span>
            case &quot;duck_pond&quot;:
<span class="nc" id="L143">                String textDuckPond = duckPondEvent(args);</span>
<span class="nc" id="L144">                game.dialogueBox.setText(textDuckPond);</span>
<span class="nc" id="L145">                break;</span>
            case &quot;exit&quot;:
                // Should do nothing and just close the dialogue menu
<span class="nc" id="L148">                game.dialogueBox.hide();</span>
<span class="nc" id="L149">                break;</span>
            default:
<span class="nc" id="L151">                String textObject = objectEvent(eventKey);</span>
<span class="nc" id="L152">                game.dialogueBox.setText(textObject);</span>
                break;

        }

<span class="nc" id="L157">    }</span>

    /**
     * Gets the interaction text associated with each object via a key
     * @param key
     * @return The object interaction text
     */
    public String getObjectInteraction(String key) {
<span class="nc bnc" id="L165" title="All 2 branches missed.">        if (key.equals(&quot;piazza&quot;)) {</span>
<span class="nc" id="L166">            return String.format(&quot;Eat %s at the Piazza?&quot;, game.getMeal());</span>
        } else {
<span class="nc" id="L168">            return objectInteractions.get(key);</span>
        }
    }

    /**
     * @return True if the object has some custom text to display that isn't just &quot;This is an x!&quot;
     */
    public boolean hasCustomObjectInteraction(String key) {
<span class="nc" id="L176">        return objectInteractions.containsKey(key);</span>
    }

    /**
     * Sets the text when talking to a tree
     */
    public String treeEvent() {
<span class="nc" id="L183">        game.dialogueBox.hideSelectBox();</span>
        //game.dialogueBox.setText(&quot;The tree doesn't say anything back.&quot;);
<span class="nc" id="L185">        return &quot;The tree doesn't say anything back.&quot;;</span>
    }

    /**
     * Sets the text when interacting with the secret area
     */
    public String chestEvent() {
<span class="nc" id="L192">        game.dialogueBox.hideSelectBox();</span>
        //game.dialogueBox.setText(&quot;Wow! These barrels is full of so many magical items! I wonder how they will help you out on your journey! Boy, this is an awfully long piece of text, I wonder if someone is testing something?\n...\n...\n...\nHow cool!&quot;);
<span class="nc" id="L194">        return &quot;Wow! These barrels is full of so many magical items! I wonder how they will help you out on your journey! Boy, this is an awfully long piece of text, I wonder if someone is testing something?\n...\n...\n...\nHow cool!&quot;;</span>
    }

    /**
     * Sets the text when talking to an object without a dedicated function
     */
    public String objectEvent(String object) {
<span class="fc" id="L201">        game.dialogueBox.hideSelectBox();</span>
        //game.dialogueBox.setText(&quot;This is a &quot; +  object + &quot;!&quot;);
<span class="fc" id="L203">        return &quot;This is a &quot; +  object + &quot;!&quot;;</span>
     }

    /**
     * Lets the player meet friends at Ron Cooke Hub for x num of hours, decreases the player's energy and increments the
     * game time.
     *
     * @param args Arguments to be passed, should contain the hours the player wants to meet friends for. E.g. [&quot;piazza&quot;, &quot;1&quot;]
     */
    public String ronCookEvent(String[] args) {
<span class="nc bnc" id="L213" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L214">            int energyCost = activityEnergies.get(&quot;meet_friends&quot;);</span>
                // If the player is too tired to meet friends
<span class="nc bnc" id="L216" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L219">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L220">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L222">                return &quot;You are too tired to meet your friends right now!&quot;;</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // Ask the player to chat about something (makes no difference)
<span class="nc" id="L225">                String[] topics = randomTopics(3);</span>
<span class="nc" id="L226">                game.dialogueBox.getSelectBox().setOptions(topics, new String[]{&quot;rch-&quot;+topics[0], &quot;rch-&quot;+topics[1], &quot;rch-&quot;+topics[2]});</span>
<span class="nc" id="L227">                return &quot;What do you want to chat about?&quot;;</span>
            } else {
                // If player conducts activities after 8pm increase night_owl streak
<span class="nc bnc" id="L230" title="All 2 branches missed.">                if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">                    if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                        // increase player's meeting friends streak if under limit
<span class="nc" id="L233">                        streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L234">                        daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                    }
                }
                // Say that the player chatted about this topic for 1-3 hours
                // RNG factor adds a slight difficulty (may consume too much energy to study)
<span class="nc" id="L239">                int hours = ThreadLocalRandom.current().nextInt(1, 4);</span>
<span class="nc" id="L240">                game.decreaseEnergy(energyCost * hours);</span>
<span class="nc" id="L241">                game.passTime(hours * 60); // in seconds</span>
<span class="nc" id="L242">                game.addRecreationalHours(hours);</span>
<span class="nc" id="L243">                return String.format(&quot;You talked about %s for %d hours!&quot;, args[1].toLowerCase(), hours);</span>
            }
        } else {
<span class="nc bnc" id="L246" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L248">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L249">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L251">            return &quot;It's too early in the morning to meet your friends, go to bed!&quot;;</span>
        }
    }

    /**
     * @param amount The amount of topics to return
     * @return An array of x random topics the player can chat about
     */
    private String[] randomTopics(int amount) {
        // Returns an array of 3 random topics
<span class="nc" id="L261">        Array&lt;String&gt; topics = new Array&lt;String&gt;(amount);</span>

<span class="nc bnc" id="L263" title="All 2 branches missed.">        for (int i = 0;i&lt;amount;i++) {</span>
<span class="nc" id="L264">            String choice = talkTopics.random();</span>
            // If statement to ensure topic hasn't already been selected
<span class="nc bnc" id="L266" title="All 2 branches missed.">            if (!topics.contains(choice, false)) {</span>
<span class="nc" id="L267">                topics.add(choice);</span>
            } else {
<span class="nc" id="L269">                i -= 1;</span>
            }
        }

<span class="nc" id="L273">        return topics.toArray(String.class);</span>
    }

    /**
     * The event to be run when interacting with the computer science building
     * Gives the player the option to study for 1, 2 or 3 hours - must go into town to study longer
     * @param args
     */
    public String compSciEvent(String[] args) {
<span class="nc bnc" id="L282" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L283">            int energyCost = activityEnergies.get(&quot;studying&quot;);</span>
            // If the player is too tired for any studying:
<span class="nc bnc" id="L285" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc" id="L286">                game.dialogueBox.hideSelectBox();</span>
                //game.dialogueBox.setText(&quot;You are too tired to study right now!&quot;);
<span class="nc bnc" id="L288" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L290">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L291">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L293">                return &quot;You are too tired to study right now!&quot;;</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // If the player has already used their catchup and studied that day, they can't study again
<span class="nc bnc" id="L296" title="All 4 branches missed.">                if (daily_study &gt;= 1 &amp;&amp; catchup_used){</span>
<span class="nc" id="L297">                    game.dialogueBox.hideSelectBox();</span>
                    //game.dialogueBox.setText(&quot;You have already studied today!&quot;);
<span class="nc" id="L299">                    return &quot;You have already studied today!&quot;;</span>
                } else{
                    // If the player has not yet chosen how many hours, ask
                    //game.dialogueBox.setText(&quot;Study for how long?&quot;);
<span class="nc" id="L303">                    game.dialogueBox.getSelectBox().setOptions(new String[]{&quot;1 Hour (10)&quot;, &quot;2 Hours (20)&quot;, &quot;3 Hours (30)&quot;}, new String[]{&quot;comp_sci-1&quot;, &quot;comp_sci-2&quot;, &quot;comp_sci-3&quot;});</span>
<span class="nc" id="L304">                    return &quot;Study for how long?&quot;;</span>
                }
            } else {
<span class="nc" id="L307">                int hours = Integer.parseInt(args[1]);</span>
                // If the player does not have enough energy for the selected hours
<span class="nc bnc" id="L309" title="All 2 branches missed.">                if (game.getEnergy() &lt; hours*energyCost) {</span>
                    //game.dialogueBox.setText(&quot;You don't have the energy to study for this long!&quot;);
<span class="nc" id="L311">                    return &quot;You don't have the energy to study for this long!&quot;;</span>
                } else {
                    // If they do have the energy to study increase streaks and complete event
<span class="nc bnc" id="L314" title="All 2 branches missed.">                    if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L315" title="All 2 branches missed.">                        if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                            // increase player's meeting friends streak if under limit
<span class="nc" id="L317">                            streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L318">                            daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                        }
                    }
<span class="nc bnc" id="L321" title="All 2 branches missed.">                    if (daily.get(&quot;studying&quot;) &lt; 1){</span>
                        // increase player's studying streak if under limit
<span class="nc" id="L323">                        streaks.put(&quot;studying&quot;, streaks.getOrDefault(&quot;studying&quot;, 0) + 1);</span>
<span class="nc" id="L324">                        daily.put(&quot;studying&quot;,daily.get(&quot;studying&quot;)+1);</span>
                    }
                    //game.dialogueBox.setText(String.format(&quot;You studied for %s hours!\nYou lost %d energy&quot;, args[1], hours*energyCost));
<span class="nc" id="L327">                    game.decreaseEnergy(energyCost * hours);</span>
<span class="nc" id="L328">                    game.addStudyHours(hours);</span>
<span class="nc" id="L329">                    game.addStudyTimes();</span>
<span class="nc" id="L330">                    daily_study++;</span>
<span class="nc bnc" id="L331" title="All 2 branches missed.">                    if (daily_study &gt; 1){</span>
<span class="nc" id="L332">                        catchup_used = GameScreen.useCatchup(catchup_used);</span>
                    }
<span class="nc" id="L334">                    game.passTime(hours * 60); // in seconds</span>
<span class="nc" id="L335">                    return String.format(&quot;You studied for %s hours!\nYou lost %d energy&quot;, args[1], hours*energyCost);</span>
                }
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early in the morning to study, go to bed!&quot;);
<span class="nc bnc" id="L340" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L342">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L343">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L345">            return &quot;It's too early in the morning to study, go to bed!&quot;;</span>
        }
    }


    /**
     * The event to be run when the player interacts with the Piazza
     * Gives the player the choice to eat breakfast, lunch or dinner depending on the time of day
     * @param args
     */
    public String piazzaEvent(String[] args) {
<span class="nc bnc" id="L356" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L357">            int energyCost = activityEnergies.get(&quot;eating&quot;);</span>
<span class="nc bnc" id="L358" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
                //game.dialogueBox.setText(&quot;You are too tired to eat right now!&quot;);
<span class="nc bnc" id="L360" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L362">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L363">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L365">                return &quot;You are too tired to eat right now!&quot;;</span>
            } else {
<span class="nc bnc" id="L367" title="All 2 branches missed.">                if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">                    if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                        // increase player's meeting friends streak if under limit
<span class="nc" id="L370">                        streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L371">                        daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                    }
                }
<span class="nc bnc" id="L374" title="All 2 branches missed.">                if (daily.get(&quot;eating&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L376">                    streaks.put(&quot;eating&quot;, streaks.getOrDefault(&quot;eating&quot;, 0) + 1);</span>
<span class="nc" id="L377">                    daily.put(&quot;eating&quot;,daily.get(&quot;eating&quot;)+1);</span>
                }
<span class="nc" id="L379">                game.decreaseEnergy(energyCost);</span>
<span class="nc" id="L380">                game.passTime(60); // in seconds</span>
<span class="nc" id="L381">                game.dialogueBox.setText(String.format(&quot;You took an hour to eat %s at the Piazza!\nYou lost %d energy!&quot;, game.getMeal(), energyCost));</span>
<span class="nc" id="L382">                return String.format(&quot;You took an hour to eat %s at the Piazza!\nYou lost 10 energy!&quot;, game.getMeal());</span>
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early in the morning to eat food, go to bed!&quot;);
<span class="nc bnc" id="L386" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L388">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L389">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L391">            return &quot;It's too early in the morning to eat food, go to bed!&quot;;</span>
        }

    }

    /**
     * The event to be run when interacting with the flowerbed bench
     * Gives the player the option to study for 1, 2 or 3 hours
     * @param args
     */
    public String flowersEvent(String[] args) {
<span class="nc bnc" id="L402" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L403">            int energyCost = activityEnergies.get(&quot;flowers&quot;);</span>
            // increase player's smelling flowers streak
<span class="nc bnc" id="L405" title="All 2 branches missed.">            if (daily.get(&quot;flowers&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L407">                streaks.put(&quot;flowers&quot;, streaks.getOrDefault(&quot;flowers&quot;, 0) + 1);</span>
<span class="nc" id="L408">                daily.put(&quot;flowers&quot;,daily.get(&quot;flowers&quot;)+1);</span>
            }
            // If the player is too tired to smell the flowers
<span class="nc bnc" id="L411" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc" id="L412">                game.dialogueBox.hideSelectBox();</span>
                //game.dialogueBox.setText(&quot;You are too tired to smell the flowers right now!&quot;);
<span class="nc bnc" id="L414" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L416">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L417">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L419">                return &quot;You are too tired to smell the flowers right now!&quot;;</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // If the player has not yet chosen how many hours, ask
                //game.dialogueBox.setText(&quot;Smell the flowers for how long?&quot;);
<span class="nc" id="L423">                game.dialogueBox.getSelectBox().setOptions(new String[]{&quot;1 Hour (10)&quot;, &quot;2 Hours (20)&quot;, &quot;3 Hours (30)&quot;}, new String[]{&quot;flowers-1&quot;, &quot;flowers-2&quot;, &quot;flowers-3&quot;});</span>
<span class="nc" id="L424">                return &quot;Smell the flowers for how long?&quot;;</span>
            } else {
<span class="nc" id="L426">                int hours = Integer.parseInt(args[1]);</span>
                // If the player does not have enough energy for the selected hours
<span class="nc bnc" id="L428" title="All 2 branches missed.">                if (game.getEnergy() &lt; hours*energyCost) {</span>
                    //game.dialogueBox.setText(&quot;What if you fell asleep? You don't have the energy!&quot;);
<span class="nc" id="L430">                    return &quot;What if you fell asleep? You don't have the energy!&quot;;</span>
                } else {
                    // If they do have the energy to smell the flowers
<span class="nc bnc" id="L433" title="All 2 branches missed.">                    if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">                        if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                            // increase player's meeting friends streak if under limit
<span class="nc" id="L436">                            streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L437">                            daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                        }
                    }
                    //game.dialogueBox.setText(String.format(&quot;You smelled the flowers for %s hours!\nYou lost %d energy&quot;, args[1], hours*energyCost));
<span class="nc" id="L441">                    game.decreaseEnergy(energyCost * hours);</span>
<span class="nc" id="L442">                    game.passTime(hours * 60); // in seconds</span>
<span class="nc" id="L443">                    game.addRecreationalHours(hours);</span>
<span class="nc" id="L444">                    return String.format(&quot;You smelled the flowers for %s hours!\nYou lost %d energy&quot;, args[1], hours*energyCost);</span>
                }
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early in the morning to smell the flowers, go to bed!&quot;);
<span class="nc bnc" id="L449" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L451">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L452">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L454">            return &quot;It's too early in the morning to smell the flowers, go to bed!&quot;;</span>
        }
    }

    /**
     * The event to be run when interacting with the bus stop to town
     * @param args
     */
    public String busStopEvent(String[] args) throws InterruptedException {
<span class="nc bnc" id="L463" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
            //Still need an energy cost to prevent player from going into town when they have no energy
<span class="nc" id="L465">            int energyCost = activityEnergies.get(&quot;town&quot;);</span>
            // If the player is too tired for any travelling:
<span class="nc bnc" id="L467" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc" id="L468">                game.dialogueBox.hideSelectBox();</span>
                //game.dialogueBox.setText(&quot;You are too tired to get the bus right now!&quot;);
<span class="nc bnc" id="L470" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L472">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L473">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L475">                return &quot;You are too tired to get the bus right now!&quot;;</span>
<span class="nc bnc" id="L476" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // Player goes into town for undefined amount of time so no need to ask
                // If the player does not have enough energy for at least one hour
<span class="nc bnc" id="L479" title="All 2 branches missed.">                if (game.getEnergy() &lt; energyCost) {</span>
                    //game.dialogueBox.setText(&quot;You don't have the energy to go into town right now!&quot;);
<span class="nc" id="L481">                    return &quot;You don't have the energy to go into town right now!&quot;;</span>
                } else {
                    // If they do have the energy to go into town
<span class="nc" id="L484">                    HustleGame.setMap();</span>
                    //game.dialogueBox.setText(&quot;You got the bus into town.&quot;);
<span class="nc" id="L486">                    return &quot;You got the bus into town.&quot;;</span>
                }
            }
<span class="nc" id="L489">        } else {</span>
            //game.dialogueBox.setText(&quot;It's too early in the morning to go into town, there are no buses yet!&quot;);
<span class="nc bnc" id="L491" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L493">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L494">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L496">            return &quot;It's too early in the morning to go into town, there are no buses yet!&quot;;</span>
        }
<span class="nc" id="L498">        return null;</span>
    }

    /**
     * The event to be run when interacting with the shop
     * Gives the player the option to buy food for 1, 2 or 3 hours
     * @param args
     */
    public String shopEvent(String[] args) {
<span class="nc bnc" id="L507" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L508">            int energyCost = activityEnergies.get(&quot;shop&quot;);</span>
            // increase player's buying food streak
<span class="nc" id="L510">            streaks.put(&quot;shop&quot;, streaks.getOrDefault(&quot;shop&quot;, 0) + 1);</span>
            // If the player has the energy to eat
<span class="nc bnc" id="L512" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
                //game.dialogueBox.setText(&quot;You are too tired to eat right now!&quot;);
<span class="nc bnc" id="L514" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L516">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L517">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L519">                return &quot;You are too tired to eat right now!&quot;;</span>
            } else {
<span class="nc bnc" id="L521" title="All 2 branches missed.">                if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L522" title="All 2 branches missed.">                    if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                        // increase player's meeting friends streak if under limit
<span class="nc" id="L524">                        streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L525">                        daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                    }
                }
<span class="nc bnc" id="L528" title="All 2 branches missed.">                if (daily.get(&quot;eating&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L530">                    streaks.put(&quot;eating&quot;, streaks.getOrDefault(&quot;eating&quot;, 0) + 1);</span>
<span class="nc" id="L531">                    daily.put(&quot;eating&quot;,daily.get(&quot;eating&quot;)+1);</span>
                }
<span class="nc" id="L533">                game.decreaseEnergy(energyCost);</span>
<span class="nc" id="L534">                game.passTime(60); // in seconds</span>
<span class="nc" id="L535">                return String.format(&quot;You took an hour to buy and eat %s at nisa!\nYou lost %d energy!&quot;, game.getMeal(), energyCost);</span>
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early in the morning to eat food, go to bed!&quot;);
<span class="nc bnc" id="L539" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L541">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L542">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L544">            return &quot;It's too early in the morning to eat food, go to bed!&quot;;</span>
        }
    }

    /**
     * Lets the player go to sleep, fades the screen to black then shows a dialogue about the amount of sleep
     * the player gets
     * Then queues up fadeFromBlack to be called when this dialogue closes
     * @see GameScreen fadeToBlack function
     * @param args Unused currently
     */
    public void accomEvent(String[] args) {
<span class="nc" id="L556">        game.setSleeping(true);</span>
<span class="nc" id="L557">        game.dialogueBox.hide();</span>

        // Reset number of times studied for new day and streaks depending on consistency
<span class="nc bnc" id="L560" title="All 2 branches missed.">        if (daily_study == 0){</span>
            //Reset study streak if player didn't study that day
<span class="nc" id="L562">            streaks.put(&quot;studying&quot;, 0);</span>
        }
<span class="nc" id="L564">        daily_study = 0;</span>

        // Reset daily for each activity to 0
<span class="nc bnc" id="L567" title="All 2 branches missed.">        for (String streak_activity : streak_activities){</span>
<span class="nc" id="L568">            daily.put(streak_activity, 0);</span>
        }

        // Calculate the hours slept to the nearest hour
        // Wakes the player up at 8am
        float secondsSlept;
<span class="nc bnc" id="L574" title="All 2 branches missed.">        if (game.getSeconds() &lt; 60*8) {</span>
<span class="nc" id="L575">            secondsSlept = (60*8 - game.getSeconds());</span>
        } else {
            // Account for the wakeup time being in the next day
<span class="nc" id="L578">            secondsSlept = (((60*8) + 1440) - game.getSeconds());</span>
        }
<span class="nc" id="L580">        int hoursSlept = Math.round(secondsSlept / 60f);</span>

<span class="nc" id="L582">        RunnableAction setTextAction = new RunnableAction();</span>
<span class="nc" id="L583">        setTextAction.setRunnable(new Runnable() {</span>
            @Override
            public void run() {
<span class="nc bnc" id="L586" title="All 2 branches missed.">                if (game.getSleeping()) {</span>
<span class="nc" id="L587">                    game.dialogueBox.show();</span>
<span class="nc" id="L588">                    game.dialogueBox.setText(String.format(&quot;You slept for %d hours!\nYou recovered %d energy!&quot;, hoursSlept, Math.min(100, hoursSlept*13)), &quot;fadefromblack&quot;);</span>
                    // Restore energy and pass time
<span class="nc" id="L590">                    game.setEnergy(hoursSlept*13);</span>
<span class="nc" id="L591">                    game.passTime(secondsSlept);</span>
<span class="nc" id="L592">                    game.addSleptHours(hoursSlept);</span>
                }
<span class="nc" id="L594">            }</span>
        });

<span class="nc" id="L597">        fadeToBlack(setTextAction);</span>
<span class="nc" id="L598">    }</span>

    //Town POIs

    /**
     * The event to be run when interacting with the gym
     * Gives the player the option to buy food for 2, 3 or 4 hours
     * @param args
     */
    public String gymEvent(String[] args) {
<span class="nc bnc" id="L608" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L609">            int energyCost = activityEnergies.get(&quot;gym&quot;);</span>
            // If the player is too tired for any travelling:
<span class="nc bnc" id="L611" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc" id="L612">                game.dialogueBox.hideSelectBox();</span>
                //game.dialogueBox.setText(&quot;You are too tired to go to the gym right now!&quot;);
<span class="nc bnc" id="L614" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L616">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L617">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L619">                return &quot;You are too tired to go to the gym right now!&quot;;</span>
<span class="nc bnc" id="L620" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // If the player has not yet chosen how many hours, ask
                //game.dialogueBox.setText(&quot;Work out for how long?&quot;);
<span class="nc" id="L623">                game.dialogueBox.getSelectBox().setOptions(new String[]{&quot;2 Hours (20)&quot;, &quot;3 Hours (30)&quot;, &quot;4 Hours (40)&quot;}, new String[]{&quot;gym-2&quot;, &quot;gym-3&quot;, &quot;gym-4&quot;});</span>
<span class="nc" id="L624">                return &quot;Work out for how long?&quot;;</span>
            } else {
<span class="nc" id="L626">                int hours = Integer.parseInt(args[1]);</span>
                // If the player does not have enough energy for the selected hours
<span class="nc bnc" id="L628" title="All 2 branches missed.">                if (game.getEnergy() &lt; hours*energyCost) {</span>
                    //game.dialogueBox.setText(&quot;You don't have the energy to go to work out right now! Head back to east!&quot;);
<span class="nc" id="L630">                    return &quot;You don't have the energy to go to work out right now! Head back to east!&quot;;</span>
                } else {
                    // If they do have the energy to work out
<span class="nc bnc" id="L633" title="All 2 branches missed.">                    if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">                        if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                            // increase player's meeting friends streak if under limit
<span class="nc" id="L636">                            streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L637">                            daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                        }
                    }
                    //game.dialogueBox.setText(String.format(&quot;You spent %s hours working out at the gym.\nYou lost %d energy&quot;, args[1], hours*energyCost));
<span class="nc" id="L641">                    game.decreaseEnergy(energyCost * hours);</span>
<span class="nc" id="L642">                    game.addRecreationalHours(hours);</span>
<span class="nc" id="L643">                    game.passTime(hours * 60); // in seconds</span>
<span class="nc" id="L644">                    return String.format(&quot;You spent %s hours working out at the gym!\nYou lost %d energy&quot;, args[1], hours*energyCost);</span>
                }
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early to work out, the gym's not open yet!&quot;);
<span class="nc bnc" id="L649" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L651">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L652">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L654">            return &quot;It's too early to work out, the gym's not open yet!&quot;;</span>
        }
    }

    /**
     * The event to be run when interacting with the duck pond
     * Gives the player the option to feed the ducks for 1, 2 or 3 hours
     * @param args
     */
    public String duckPondEvent(String[] args) {
<span class="nc bnc" id="L664" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L665">            int energyCost = activityEnergies.get(&quot;duck_pond&quot;);</span>
            // If the player is too tired for any travelling:
<span class="nc bnc" id="L667" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc" id="L668">                game.dialogueBox.hideSelectBox();</span>
                //game.dialogueBox.setText(&quot;You are too tired to feed the ducks right now!&quot;);
<span class="nc bnc" id="L670" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L672">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L673">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L675">                return &quot;You are too tired to feed the ducks right now!&quot;;</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // If the player has not yet chosen how many hours, ask
                //game.dialogueBox.setText(&quot;Feed the ducks for how long?&quot;);
<span class="nc" id="L679">                game.dialogueBox.getSelectBox().setOptions(new String[]{&quot;1 Hour (10)&quot;, &quot;2 Hours (20)&quot;, &quot;3 Hours (30)&quot;}, new String[]{&quot;duck_pond-1&quot;, &quot;duck_pond-2&quot;, &quot;duck_pond-3&quot;});</span>
<span class="nc" id="L680">                return &quot;Feed the ducks for how long?&quot;;</span>
            } else {
<span class="nc" id="L682">                int hours = Integer.parseInt(args[1]);</span>
                // If the player does not have enough energy for the selected hours
<span class="nc bnc" id="L684" title="All 2 branches missed.">                if (game.getEnergy() &lt; hours*energyCost) {</span>
                    //game.dialogueBox.setText(&quot;You don't have the energy to feed the ducks right now! Head back to east!&quot;);
<span class="nc" id="L686">                    return &quot;You don't have the energy to feed the ducks right now! Head back to east!&quot;;</span>
                } else {
                    // If they do have the energy to feed the ducks
<span class="nc bnc" id="L689" title="All 2 branches missed.">                    if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L690" title="All 2 branches missed.">                        if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                            // increase player's meeting friends streak if under limit
<span class="nc" id="L692">                            streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L693">                            daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                        }
                    }
                    //game.dialogueBox.setText(String.format(&quot;You spent %s hours feeding the ducks.\nYou lost %d energy&quot;, args[1], hours*energyCost));
<span class="nc" id="L697">                    game.decreaseEnergy(energyCost * hours);</span>
<span class="nc" id="L698">                    game.passTime(hours * 60); // in seconds</span>
<span class="nc" id="L699">                    game.addRecreationalHours(hours);</span>
<span class="nc" id="L700">                    return String.format(&quot;You spent %s hours feeding the ducks!\nYou lost %d energy&quot;, args[1], hours*energyCost);</span>
                }
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early to feed the ducks, they're not hungry!&quot;);
<span class="nc bnc" id="L705" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L707">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L708">                daily.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L710">            return &quot;It's too early to feed the ducks, they're not hungry!&quot;;</span>
        }
    }

    /**
     * The event to be run when interacting with the library
     * Gives the player the option to study for 2, 3 or 4 hours - must go into town to study longer
     * @param args
     */
    public String libraryEvent(String[] args) {
<span class="nc bnc" id="L720" title="All 2 branches missed.">        if (game.getSeconds() &gt; 8*60) {</span>
<span class="nc" id="L721">            int energyCost = activityEnergies.get(&quot;library&quot;);</span>
            // If the player is too tired for any studying:
<span class="nc bnc" id="L723" title="All 2 branches missed.">            if (game.getEnergy() &lt; energyCost) {</span>
<span class="nc" id="L724">                game.dialogueBox.hideSelectBox();</span>
                //game.dialogueBox.setText(&quot;You are too tired to study at the library right now!&quot;);
<span class="nc bnc" id="L726" title="All 2 branches missed.">                if (daily.get(&quot;determined&quot;) &lt; 3){</span>
                    // increase player's meeting friends streak if under limit
<span class="nc" id="L728">                    streaks.put(&quot;determined&quot;, streaks.getOrDefault(&quot;determined&quot;, 0) + 1);</span>
<span class="nc" id="L729">                    daily.put(&quot;determined&quot;,daily.get(&quot;determined&quot;)+1);</span>
                }
<span class="nc" id="L731">                return &quot;You are too tired to study at the library right now!&quot;;</span>
<span class="nc bnc" id="L732" title="All 2 branches missed.">            } else if (args.length == 1) {</span>
                // If the player has already used their catchup and studied that day, they can't study again
<span class="nc bnc" id="L734" title="All 4 branches missed.">                if (daily_study &gt;= 1 &amp;&amp; catchup_used){</span>
<span class="nc" id="L735">                    game.dialogueBox.hideSelectBox();</span>
                    //game.dialogueBox.setText(&quot;You have already studied today!&quot;);
<span class="nc" id="L737">                    return &quot;You have already studied today!&quot;;</span>
                }else{
                    // If the player has not yet chosen how many hours, ask
                    //game.dialogueBox.setText(&quot;Study for how long?&quot;);
<span class="nc" id="L741">                    game.dialogueBox.getSelectBox().setOptions(new String[]{&quot;2 Hours (20)&quot;, &quot;3 Hours (30)&quot;, &quot;4 Hours (40)&quot;}, new String[]{&quot;library-2&quot;, &quot;library-3&quot;, &quot;library-4&quot;});</span>
<span class="nc" id="L742">                    return &quot;Study for how long?&quot;;</span>
                }
            } else {
<span class="nc" id="L745">                int hours = Integer.parseInt(args[1]);</span>
                // If the player does not have enough energy for the selected hours
<span class="nc bnc" id="L747" title="All 2 branches missed.">                if (game.getEnergy() &lt; hours*energyCost) {</span>
                    //game.dialogueBox.setText(&quot;You don't have the energy to study for this long! Head back to east!&quot;);
<span class="nc" id="L749">                    return &quot;You don't have the energy to study for this long! Head back to east!&quot;;</span>
                } else {
                    // If they do have the energy to study
<span class="nc bnc" id="L752" title="All 2 branches missed.">                    if (daily.get(&quot;studying&quot;) &lt; 1){</span>
                        // increase player's meeting friends streak if under limit
<span class="nc" id="L754">                        streaks.put(&quot;studying&quot;, streaks.getOrDefault(&quot;studying&quot;, 0) + 1);</span>
<span class="nc" id="L755">                        daily.put(&quot;studying&quot;,daily.get(&quot;studying&quot;)+1);</span>
                    }
<span class="nc bnc" id="L757" title="All 2 branches missed.">                    if (game.getSeconds() &gt; 20*60){</span>
<span class="nc bnc" id="L758" title="All 2 branches missed.">                        if (daily.get(&quot;night_owl&quot;) &lt; 3){</span>
                            // increase player's meeting friends streak if under limit
<span class="nc" id="L760">                            streaks.put(&quot;night_owl&quot;, streaks.getOrDefault(&quot;night_owl&quot;, 0) + 1);</span>
<span class="nc" id="L761">                            daily.put(&quot;night_owl&quot;,daily.get(&quot;night_owl&quot;)+1);</span>
                        }
                    }
<span class="nc" id="L764">                    streaks.put(&quot;library&quot;, streaks.getOrDefault(&quot;library&quot;, 0) + 1);</span>
                    //game.dialogueBox.setText(String.format(&quot;You studied for %s hours!\nYou lost %d energy&quot;, args[1], hours*energyCost));
<span class="nc" id="L766">                    game.decreaseEnergy(energyCost * hours);</span>
<span class="nc" id="L767">                    game.addStudyHours(hours);</span>
<span class="nc" id="L768">                    game.addStudyTimes();</span>
<span class="nc" id="L769">                    daily_study++;</span>
<span class="nc bnc" id="L770" title="All 2 branches missed.">                    if (daily_study &gt; 1){</span>
<span class="nc" id="L771">                        catchup_used = GameScreen.useCatchup(catchup_used);</span>
                    }
<span class="nc" id="L773">                    game.passTime(hours * 60); // in seconds</span>
<span class="nc" id="L774">                    return String.format(&quot;You studied for %s hours!\nYou lost %d energy&quot;, args[1], hours*energyCost);</span>
                }
            }
        } else {
            //game.dialogueBox.setText(&quot;It's too early in the morning to study, go to bed!&quot;);
<span class="nc bnc" id="L779" title="All 2 branches missed.">            if (daily.get(&quot;early_bird&quot;) &lt; 3){</span>
                // increase player's meeting friends streak if under limit
<span class="nc" id="L781">                streaks.put(&quot;early_bird&quot;, streaks.getOrDefault(&quot;early_bird&quot;, 0) + 1);</span>
<span class="nc" id="L782">                streaks.put(&quot;early_bird&quot;,daily.get(&quot;early_bird&quot;)+1);</span>
            }
<span class="nc" id="L784">            return &quot;It's too early in the morning to study, go to bed!&quot;;</span>
        }
    }

    /**
     * The event to be run when interacting with the bus stop back to east
     * @param args
     */
    public void townBusStopEvent(String[] args) throws InterruptedException {
        // Player must be able to get back to east at any time in the game, so energy and time of day are irrelevant
<span class="nc" id="L794">        gotBus = true;</span>
<span class="nc" id="L795">        HustleGame.setMap();</span>
<span class="nc" id="L796">        game.dialogueBox.setText(&quot;You got the bus back to east.&quot;);</span>
<span class="nc" id="L797">    }</span>

    /**
     * gets the Players current actvity streaks in the game to be used for gaining acheivements
     * @return
     */

    public static HashMap&lt;String, Integer&gt; getStreaks(){
<span class="nc" id="L805">        return streaks;</span>
    }

    

    /**
     * Fades the screen to black
     */
    public void fadeToBlack() {
<span class="nc" id="L814">        game.blackScreen.addAction(Actions.fadeIn(3f));</span>
<span class="nc" id="L815">    }</span>

    /**
     * Fades the screen to black, then runs a runnable after it is done
     * @param runnable A runnable to execute after fading is finished
     */
    /**
     * Fades the screen to black, executes runnable action after fadde
     * @ param runnable the runnable exection to be executed
     */
    public void fadeToBlack(RunnableAction runnable) {
<span class="nc" id="L826">        game.blackScreen.addAction(Actions.sequence(Actions.fadeIn(3f), runnable));</span>
<span class="nc" id="L827">    }</span>

    /**
     * Fades the screen back in from black, displays a good morning message if the player was sleeping
     */
    public void fadeFromBlack() {
        // If the player is sleeping, queue up a message to be sent
<span class="nc bnc" id="L834" title="All 2 branches missed.">        if (game.getSleeping()) {</span>
<span class="nc" id="L835">            RunnableAction setTextAction = new RunnableAction();</span>
<span class="nc" id="L836">            setTextAction.setRunnable(new Runnable() {</span>
                @Override
                public void run() {
<span class="nc bnc" id="L839" title="All 2 branches missed.">                    if (game.getSleeping()) {</span>
<span class="nc" id="L840">                        game.dialogueBox.show();</span>
                        // Show a text displaying how many days they have left in the game
<span class="nc" id="L842">                        game.dialogueBox.setText(game.getWakeUpMessage());</span>
<span class="nc" id="L843">                        game.setSleeping(false);</span>
                    }
<span class="nc" id="L845">                }</span>
            });

            // Queue up events
<span class="nc" id="L849">            game.blackScreen.addAction(Actions.sequence(Actions.fadeOut(3f), setTextAction));</span>
<span class="nc" id="L850">        } else {</span>
<span class="nc" id="L851">            game.blackScreen.addAction(Actions.fadeOut(3f));</span>
        }
<span class="nc" id="L853">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>